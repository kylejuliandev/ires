@inject IresDbContext Context
@inject IJSRuntime JSRuntime

<div class="col-sm-6 mb-3">
    <div class="card">
        <div class="card-body">
            <h6 class="card-title pb-3">@Address.Street</h6>
            <p class="address-line">@Address.City</p>
            <p class="address-line">@Address.State</p>
            <p class="address-line">@Address.Country</p>
            <p class="address-line">@Address.PostalCode</p>
            <div class="d-flex justify-content-end" style="margin-top:-1rem;">
                <button class="btn btn-link card-link" type="button" @onclick="() => DeleteAddressAsync(Address)">Delete</button>
            </div>
        </div>
    </div>
</div>

@code {
    [Parameter]
    public required Address Address { get; set; }

    [Parameter]
    public required EventCallback OnAddressDeleted { get; set; }

    private async Task DeleteAddressAsync(Address address)
    {
        var confirmed = await JSRuntime.InvokeAsync<bool>("confirm", $"Are you sure you want to delete this address?");
        if (confirmed)
        {
            Context.Addresses.Remove(address);
            await Context.SaveChangesAsync();

            await OnAddressDeleted.InvokeAsync();
        }
    }
}
