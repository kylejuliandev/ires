services:
  aspire-dashboard:
    image: mcr.microsoft.com/dotnet/aspire-dashboard:latest@sha256:f287c6954596315ada6fb45af6ed2e451c45658aeb68d98dc1cfed5b5b253895
    ports:
      - "18888:18888"
      - "4317:18889"
  frontend:
    image: ghcr.io/kylejuliandev/ires:v1.1.0@sha256:53aa851475f9e1a75cde39f4160b11103098a83978d222bb725d0f9780820937
    environment:
      OTEL_DOTNET_EXPERIMENTAL_OTLP_EMIT_EXCEPTION_LOG_ATTRIBUTES: "true"
      OTEL_DOTNET_EXPERIMENTAL_OTLP_EMIT_EVENT_LOG_ATTRIBUTES: "true"
      OTEL_DOTNET_EXPERIMENTAL_OTLP_RETRY: "in_memory"
      ASPNETCORE_FORWARDEDHEADERS_ENABLED: "true"
      HTTP_PORTS: 8080
      DB_LOCATION: "/data/ires.db"
      OTEL_EXPORTER_OTLP_ENDPOINT: "http://aspire-dashboard:18889"
      OTEL_EXPORTER_OTLP_PROTOCOL: "grpc"
      OTEL_SERVICE_NAME: "frontend"
      Auth__Users__admin: ${ADMIN_PASSWORD}
    env_file:
      - path: .env
        required: true
    ports:
      - "8080:8080"
    volumes:
      - ./data:/data